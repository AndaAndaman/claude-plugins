---
name: instinct-export-context
description: Export auto-approved instincts as project context to a learned-patterns file
allowed-tools:
  - Read
  - Write
  - Glob
  - Grep
---

# Instinct Export Context Command

Export auto-approved instincts as a readable markdown file that can be discovered by local-memory or used as project documentation.

## Execution Workflow

### Step 0: Load Configuration

Read the plugin's `config/defaults.json` for threshold values. Then check `.claude/md-to-skill.local.md` for user overrides.

Key config values:
- `instincts.autoApproveThreshold` (default: 0.7)
- `integration.localMemoryExportEnabled` (default: true)

If `integration.localMemoryExportEnabled` is false:
```
Local memory export is disabled in configuration.
Set localMemoryExportEnabled: true in .claude/md-to-skill.local.md to enable.
```
Exit.

### Step 1: Load Auto-Approved Instincts

Use Glob to find all instinct files:
```
.claude/md-to-skill-instincts/*.md
```

For each file, read and parse YAML frontmatter. Filter for instincts where `auto_approved: true`.

If no auto-approved instincts found:
```
No auto-approved instincts yet.

Instincts reach auto-approve status when their confidence reaches 0.7+.
Run /observe to analyze tool use patterns and grow instinct confidence.
```
Exit.

### Step 2: Group by Domain

Organize the filtered instincts by their `domain` field. Common domains include:
- `code-style` — naming, formatting, syntax preferences
- `testing` — test patterns and verification habits
- `workflow` — command sequences and process patterns
- `tooling` — tool preferences and usage patterns

### Step 3: Generate Markdown

Build a markdown document with the following structure:

```markdown
## Learned Patterns (auto-generated by md-to-skill)

### {Domain Name}
- {Trigger description} (confidence: {confidence}, {observations} observations)

### {Domain Name}
- {Trigger description} (confidence: {confidence}, {observations} observations)

*Last exported: {ISO timestamp}*
*Run /instinct-export-context to refresh*
```

Example:
```markdown
## Learned Patterns (auto-generated by md-to-skill)

### Code Style
- When writing TypeScript files, prefer arrow functions (confidence: 0.8, 12 observations)
- Use kebab-case for file naming (confidence: 0.75, 8 observations)

### Testing
- Always run tests after editing source files (confidence: 0.85, 15 observations)

### Workflow
- Run lint before commit (confidence: 0.7, 6 observations)

*Last exported: 2026-02-11T10:30:00*
*Run /instinct-export-context to refresh*
```

### Step 4: Write Output

Write the generated markdown to `.claude/learned-patterns.md`.

This file is:
- Safe and non-destructive (standalone file, not modifying CLAUDE.md)
- Discoverable by local-memory plugin for context generation
- Human-readable for direct reference

Show summary:
```
## Export Complete

Exported {count} auto-approved instincts across {domain_count} domains to:
  .claude/learned-patterns.md

Domains:
- {domain}: {count} patterns
- {domain}: {count} patterns

This file can be discovered by local-memory for project context.
Run /instinct-export-context again to refresh after new instincts are approved.
```

## Error Handling

**Malformed frontmatter:** Skip that instinct file, note in output: "{count} instinct files could not be parsed".

**No .claude directory:** Create it before writing.
